"use strict";angular.module("appApp",["ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","leaflet-directive","LocalStorageModule","ngDialog","ngHello","ui.tinymce","angular-intro"]).config(["helloProvider",function(a){a.init({facebook:"269509866781876",google:"49433176261-hjeueecpafioh56r67fik9nqkum5np0g.apps.googleusercontent.com"})}]).config(["$logProvider",function(a){a.debugEnabled(!1)}]).config(["localStorageServiceProvider",function(a){a.setPrefix("myVille")}]).config(["$httpProvider",function(a){a.interceptors.push(["localStorageService",function(a){return{request:function(b){var c=a.get("token");return b.headers=b.headers||{},null!==c&&(b.headers["x-access-token"]=c),b||Promise.resolve(b)},requestError:function(a){return Promise.reject(a)},response:function(b){var c=a.get("token"),d=b.headers("x-access-token");return null!==d&&c!==d&&a.set("token",d),b||Promise.resolve(b)},responseError:function(a){return Promise.reject(a)}}}])}]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{controller:"MainCtrl",controllerAs:"main"}).when("/login",{controller:"LoginCtrl",controllerAs:"login",templateUrl:"views/login.html"}).when("/user/:userId",{controller:"ProfileCtrl",controllerAs:"profile",templateUrl:"views/profile.html"}).when("/profile/update",{controller:"ProfileCtrl",controllerAs:"profile",templateUrl:"views/profile_update.html",resolve:{auth:["AuthentificationService",function(a){return a.routeGuardian()}]}}).when("/createUA",{controller:"UACtrl",controllerAs:"ua",templateUrl:"views/ua.html",resolve:{auth:["AuthentificationService",function(a){return a.routeGuardian()}]}}).when("/profile/mine",{controller:"MineCtrl",controllerAs:"mine",templateUrl:"views/mine.html",resolve:{auth:["AuthentificationService",function(a){return a.routeGuardian()}]}}).when("/profile/favorite",{controller:"FavoriteCtrl",controllerAs:"favorite",templateUrl:"views/favorite.html",resolve:{auth:["AuthentificationService",function(a){return a.routeGuardian()}]}}).when("/ua/:uaId",{controller:"MainCtrl",controllerAs:"main",template:" "}).when("/reset/:tokenReset",{controller:"MainCtrl",controllerAs:"main",template:" "}).otherwise({redirectTo:"/"}),b.html5Mode(!1).hashPrefix("")}]),angular.module("appApp").filter("formatDate",["$filter",function(a){return function(a){return a?moment(new Date(a)).locale("fr").fromNow():""}}]),angular.module("appApp").provider("hello",function(){this.$get=function(){return hello},this.init=function(a,b){hello.init(a,b)}}),angular.module("appApp").controller("MainCtrl",["$scope","$location","localStorageService","$timeout","$window","$rootScope","ngDialog","myVilleAPI","leafletData","AuthentificationService","$routeParams","$compile",function(a,b,c,d,e,f,g,h,i,j,k,l){a.resetPwd={},a.getPopupDescriptionUA=function(a){h.UAS.getOne(a).then(function(a){g.open({data:a.data,controller:"VoteCtrl",template:"views/single_ua.html",appendClassName:"modal-single-ua"})})},a.forgotClick=function(){if(a.resetPwd.pwd1!==a.resetPwd.pwd2)return void(a.message="Mot de passe différent.");var b={tokenReset:a.ngDialogData.token,password:a.resetPwd.pwd1};h.User.reset(b).then(function(){a.closeThisDialog()})["catch"](function(b){a.message=b.data.message})},a.isActive=function(a){var c=a===b.path();return c},a.disconnect=function(){j.logout(),e.location.href="#/"},a.login=function(){g.open({controller:"LoginCtrl",template:"views/login.html",appendClassName:"popup-auto-height"})},a.submitUA=function(){a.$broadcast("submitUA")},a.selectFilter=function(b){0===b&&(a.filters={all:!0,popular:!1,mine:!1,favorite:!1}),1===b&&(a.filters={all:!1,popular:!0,mine:!1,favorite:!1}),2===b&&(a.filters={all:!1,popular:!1,mine:!0,favorite:!1}),3===b&&(a.filters={all:!1,popular:!1,mine:!1,favorite:!0})},a.$watch("filters",function(a,b){JSON.stringify(a)!==JSON.stringify(b)&&n(),a.popular&&(e.location.href="#/"),a.all&&(e.location.href="#/"),a.mine&&(e.location.href="#/profile/mine"),a.favorite&&(e.location.href="#/profile/favorite")},!0),a.$on("filterForce",function(b,c){a.selectFilter(c)});var m,n=function(){i.getMap().then(function(b){try{b.removeLayer(m)}catch(c){}var d=[[b.getBounds().getNorthWest().lng,b.getBounds().getNorthWest().lat],[b.getBounds().getSouthEast().lng,b.getBounds().getSouthEast().lat]],e=a.filters.mine?h.UAS.getMine:a.filters.popular?h.UAS.getPopular:a.filters.all?h.UAS.getAll:h.UAS.getFavorites;e({map:JSON.stringify(d)}).then(function(c){f.cachedMarkers=c.data,m=L.geoJson(c.data,{onEachFeature:function(b,c){var d="fa fa-star-o";f.user&&-1!==f.user.favoris.indexOf(b.properties._doc._id)&&(d="fa fa-star");var e=f.user?'<i id="'+b.properties._doc._id+'" class="'+d+'" ng-click="editFavori(\''+b.properties._doc._id+'\')" aria-hidden="true"></i>':"",g='<div class="popup-map"><div class="heading-popup"><a href="javascript:void(0)" ng-click="getPopupDescriptionUA(\''+b.properties._doc._id+"')\">"+b.properties._doc.title+"</a>"+e+'</div><div class="owner-popup">Crée par <a href="#/user/'+b.properties._doc.owner._id+'">'+b.properties._doc.owner.username+"</a> "+moment(new Date(b.properties._doc.createdAt)).locale("fr").fromNow()+"</div></div>",h=l(g),i=h(a);c.bindPopup(i[0])}}),m.addTo(b)})})};a.editFavori=function(a){h.UAS.favor({ua:a}).then(function(b){f.user.favoris=b.data.favoris,c.set("user",b.data),"fa fa-star-o"===angular.element(document.getElementById(a))[0].className?angular.element(document.getElementById(a))[0].className="fa fa-star":angular.element(document.getElementById(a))[0].className="fa fa-star-o",f.$broadcast("updateFavorite")})},a.$on("leafletDirectiveMap.map.dragend",n),a.$on("leafletDirectiveMap.map.zoomend",n),a.$on("centerOnMap",function(b,c){var d,e,f=c[0];"Polygon"===f.type?(d=c[0].coordinates[0][0],e=14):"Point"===f.type?(d=c[0].coordinates,e=18):"LineString"===f.type&&(d=c[0].coordinates[0],e=14),a.center.lat=d[1],a.center.lng=d[0],a.center.zoom=e}),a.$on("$locationChangeStart",function(b,c,d){"http://localhost:9000/#/profile/mine"===c&&d!==c&&(a.filters.mine=!0,a.filters.popular=!1,a.filters.favorite=!1,a.filters.all=!1),"http://localhost:9000/#/profile/favorite"===c&&d!==c&&(a.filters.mine=!1,a.filters.popular=!1,a.filters.favorite=!0,a.filters.all=!1),a.$emit("normalMode")}),a.$on("filtersReset",function(b,c){c&&(a.filters={all:!1,popular:!1,mine:!1,favorite:!1})}),angular.extend(a,{center:{lat:51.505,lng:-.09,zoom:14,autoDiscover:!0},bounds:{},geojson:{},filters:{all:!0,popular:!1,mine:!1,favorite:!1}});var o=new L.FeatureGroup,p={edit:{featureGroup:o},draw:{circle:!1},showRadius:!0},q=new L.Control.Draw(p),r=!1;a.$on("normalMode",function(){r&&i.getMap().then(function(a){a.removeLayer(o),a.removeControl(q),r=!1})}),a.$on("editMode",function(){i.getMap().then(function(b){r||(o=new L.FeatureGroup,p={edit:{featureGroup:o},draw:{circle:!1},showRadius:!0},q=new L.Control.Draw(p),b.addControl(q),b.on("draw:created",function(c){var d=(c.layerType,c.layer);o.addLayer(d),b.addLayer(o),a.$broadcast("drawingData",o.toGeoJSON())}),r=!0)})});var s=c.get("expiryToken");if(s&&Date.now()<s){var t=c.get("token");if(t){f.token=t;var u=c.get("user");u&&(f.user=u)}}else a.disconnect();k.uaId&&h.UAS.getOne(k.uaId).then(function(b){a.center.lat=b.data.location.coordinates[1],a.center.lng=b.data.location.coordinates[0],a.center.zoom=18,g.open({data:b.data,template:"views/single_ua.html",appendClassName:"modal-single-ua"})}),k.tokenReset&&(a.resetPwd={},g.open({data:{token:k.tokenReset},controller:"MainCtrl",template:"views/reset_password.html",appendClassName:"modal-single-ua"}));var v=c.get("tutorialMode");v||(a.IntroOptions={steps:[{element:document.querySelector(".container"),intro:"Bienvenue sur myVille ! \n myVille est un site colloboratif où vous pouvez partager vos aménagements urbains à la communauté :)"},{element:document.querySelector(".sidebar"),intro:"Ça c'est la barre de menu !",position:"right"},{element:document.querySelector("#map"),intro:"Là tu peux naviguer sur la carte et voir les aménagements d'autres personnes, les aimer, les partager ..."}],showStepNumbers:!1,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"Suivant",prevLabel:"Précédent",skipLabel:"Quitter",doneLabel:"Quitter"},d(function(){a.startIntro(),c.set("tutorialMode","mode1")},500)),a.$on("firstLoginTutorial",function(){var b=c.get("tutorialMode");j.routeGuardian()&&b&&"mode1"===b&&d(function(){angular.extend(a,{IntroOptions:{steps:[{intro:"Bienvenue sur myVille ! Nous allons vous présentez les fonctionnalités du site."},{element:"#link-create",intro:"Ici, vous pouvez créer votre aménagement.",position:"right"},{element:"#link-mine",intro:"Par là, vous pouvez voir vos créations.",position:"right"},{element:"#link-favorite",intro:"Envie de lister vos favoris , il suffit de cliquer ici.",position:"right"},{intro:"Il suffit de cliquer sur un marqueur ou une forme pour voir les détails de cet aménagement.",position:"right"}],showStepNumbers:!1,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"Suivant",prevLabel:"Précédent",skipLabel:"Quitter",doneLabel:"Quitter"}}),d(function(){a.startIntro(),c.set("tutorialMode","finished")},200)},1e3)})}]),angular.module("appApp").controller("LoginCtrl",["$rootScope","$scope","$window","myVilleAPI","AuthentificationService","hello","ngDialog","$location",function(a,b,c,d,e,f,g,h){b.user={},b.signupUser={},b.forgotPwd={},b.log=!0;var i=function(a){var c={google:{scope:"basic,email",apiCall:d.User.loginGoogle},facebook:{scope:"basic, email",apiCall:d.User.loginFacebook}};f(a).login({scope:c[a].scope}).then(function(d){d.network===a&&c[a].apiCall({accessToken:d.authResponse.access_token}).then(function(a){e.login(a.data.token,a.data.user),b.closeThisDialog()})})};b.loginClick=function(){b.user.username||b.user.password?d.User.login(b.user).then(function(a){return a.data.user?(e.login(a.data.token,a.data.user),b.message="",void b.closeThisDialog()):void(b.message="Mauvaise combinaison")},function(a){b.message=a.data.message}):b.message="Error, fiels needed."},b.switchMode=function(a){b.message="","login"===a&&(b.log=1),"signup"===a&&(b.log=2),"forgot"===a&&(b.log=3)},b.createClick=function(){if(!(b.signupUser.nickname&&b.signupUser.password&&b.signupUser.email&&b.signupUser.phonenumber))return void(b.message="Un ou des champs sont manquant.");var a={username:b.signupUser.nickname,password:b.signupUser.password,email:b.signupUser.email,phonenumber:b.signupUser.phonenumber};d.User.create(a).then(function(a){e.login(a.data.token,a.data.user)}),g.close(),h.path("/")},b.forgotClick=function(){return b.forgotPwd.email?void d.User.forgot({email:b.forgotPwd.email}).then(function(a){b.switchMode("login"),b.message="Mail de récupération de mot de passe envoyé !"})["catch"](function(a){b.message=a.data.message}):void(b.message="Un ou des champs sont manquants.")},b.loginFB=function(){i("facebook")},b.loginGoogle=function(){i("google")}}]),angular.module("appApp").factory("myVilleAPI",["$http","$rootScope",function(a,b){var c="http://localhost:3000",d={User:{login:function(b){return a.post(c+"/user/login",b)},loginFacebook:function(b){return a.post(c+"/user/login/facebook",b)},loginGoogle:function(b){return a.post(c+"/user/login/google",b)},create:function(b){return a.post(c+"/user/create",b)},update:function(b){return a.put(c+"/user/update",b)},updateAvatar:function(b){return a.post(c+"/user/update/avatar",b,{transformRequest:angular.identify,headers:{"Content-Type":void 0,enctype:"multipart/form-data"}})},get:function(b){return a.get(c+"/user/"+b)},forgot:function(b){return a.post(c+"/user/forgetPassword",b)},reset:function(b){return a.post(c+"/user/reset",b)}},UAS:{getFavorites:function(b){return a.get(c+"/ua/get/favorite",{params:b})},create:function(b){return a.post(c+"/ua/create",b)},getPopular:function(b){return a.get(c+"/ua/get/popular",{params:b})},getAll:function(b){return a.get(c+"/ua/get/geo",{params:b})},getMine:function(){return a.get(c+"/ua/get/mine")},getOne:function(b){return a.get(c+"/ua/"+b)},favor:function(b){return a.post(c+"/ua/favor",b)},update:function(b,d){return a.put(c+"/ua/"+b,d)},"delete":function(b){return a["delete"](c+"/ua/"+b)},vote:function(b,d){return a.post(c+"/ua/vote/"+b,d)},deleteVote:function(b){return a["delete"](c+"/ua/vote/"+b)}},Vote:{getVote:function(b){return a.get(c+"/vote/"+b)}}};return d}]),angular.module("appApp").factory("AuthentificationService",["$rootScope","localStorageService",function(a,b){return{routeGuardian:function(){return a.user?!0:void Promise.reject("Authentification needed.")},login:function(c,d){a.token=c,a.user=d,b.set("expiryToken",Date.now()+864e5),b.set("token",c),b.set("user",d),a.$broadcast("firstLoginTutorial"),a.$broadcast("leafletDirectiveMap.map.dragend")},logout:function(){delete a.token,delete a.user,b.remove("token"),b.remove("user"),b.remove("expiryToken"),a.$broadcast("filterForce",0),a.$broadcast("leafletDirectiveMap.map.dragend")},updateAvatar:function(c){a.user=c.data,b.set("user",c.data)}}}]),angular.module("appApp").directive("ngLoading",["$http",function(a){return{restrict:"A",link:function(b,c){function d(a){a?c.show():c.hide()}function e(){return a.pendingRequests.length>0}b.isLoading=e,b.$watch(b.isLoading,d)}}}]),angular.module("appApp").directive("collapseSidebar",["$timeout",function(a){return{restrict:"AE",replace:!0,transclude:!0,require:"?headingTitle",template:'<div class="wrapper-side-sidebar"><div class="heading-side"><a href="/#/"><i class="fa fa-chevron-left back"></i></a><div class="heading-title">{{headingtitle}}</div></div><div class="content-side" ng-transclude></div></div>',link:function(a,b,c){c.$observe("headingTitle",function(b){a.headingtitle=b})}}}]),angular.module("appApp").controller("ProfileCtrl",["$scope","$rootScope","myVilleAPI","AuthentificationService","$routeParams",function(a,b,c,d,e){a.editUser=Object.assign({},a.user),a.editBox=function(){a.editMode?a.editMode=!1:a.editMode=!0},a.editClick=function(){if(!a.editUser.username)return void(a.message="Le champ pseudonyme ne peut pas être vide.");if(!a.editUser.Opassword&&a.editUser.Npassword)return void(a.message="Nous avons besoin de votre ancien mot de passe.");var d={username:a.editUser.username,password:a.editUser.Npassword,oldPassword:a.editUser.Opassword};c.User.update(d).then(function(c){b.user.username=a.editUser.username,a.editMode=!1,a.message=""},function(b){a.message=b.data.message})},a.editAvatarClick=function(b){var e=b.files,f=new FileReader;f.readAsDataURL(e[0]),f.onload=function(b){var f=new FormData;f.append("avatar",e[0]),c.User.updateAvatar(f).then(function(a){d.updateAvatar(a)},function(b){a.message=b.data.message})}},a.editMode=!1,e.userId&&c.User.get(e.userId).then(function(b){a.userWanted={avatar:b.data.avatar,username:b.data.username}})}]),angular.module("appApp").controller("FavoriteCtrl",["$rootScope","$scope","myVilleAPI",function(a,b,c){b.$emit("filterForce",3);var d=function(){if(b.favorites=a.user.favoris,b.tabFavorite=[],null!==b.favorites)for(var d=0;d<b.favorites.length;d++)c.UAS.getOne(b.favorites[d]).then(function(a){c.User.get(a.data.owner).then(function(c){var d={ua:a,owner:c.data.username};b.tabFavorite.push(d)})})};d(),b.$on("updateFavorite",function(){d()}),b.centerOnMap=function(a){b.$emit("centerOnMap",a)}}]),angular.module("appApp").controller("UACtrl",["$rootScope","$scope","$window","myVilleAPI","localStorageService","$location","ngDialog",function(a,b,c,d,e,f,g){b.$emit("editMode"),angular.element(document.getElementById("map"))[0].style.flex=0,angular.element(document.getElementsByClassName("side-sidebar")[0])[0].style.flex=1,b.ua={},b.tinymceOptions={onChange:function(a){},inline:!1,plugins:"advlist autolink link image lists charmap preview textcolor",skin:"lightgray",theme:"modern",height:"250px"},b.okClick=function(){b.closeThisDialog()},b.$on("ngDialog.closing",function(){b.$emit("leafletDirectiveMap.map.zoomend"),c.location="#/"}),b.$on("drawingData",function(a,c){b.ua.drawing=c}),b.$on("submitUA",function(a,c){if(angular.element(document.getElementById("map"))[0].style.flex=0,angular.element(document.getElementsByClassName("create-ua-button")[0])[0].style.display="none",angular.element(document.getElementsByClassName("side-sidebar")[0])[0].style.display="flex",!b.ua.desc||!b.ua.title)return void(b.message="Un ou des champs sont manquants.");if(!b.ua.drawing)return void(b.message="Vous devez dessiner sur la carte !");var e={title:b.ua.title,description:b.ua.desc,geojson:JSON.stringify(b.ua.drawing)};d.UAS.create(e).then(function(a){g.open({controller:"UACtrl",template:"views/modalUaCreated.html",appendClassName:"popup-auto-height"}),b.ua.title=null,b.ua.desc=null,b.ua.drawing=null},function(a){b.message=a.data.message,console.log(a.data)})}),b.$on("$destroy",function(){b.$emit("normalMode"),angular.element(document.getElementById("map"))[0].style.flex=1,angular.element(document.getElementsByClassName("create-ua-button")[0])[0].style.display="none",angular.element(document.getElementsByClassName("side-sidebar")[0])[0].style.display="flex"}),b.showEditMap=function(){angular.element(document.getElementById("map"))[0].style.flex=1,angular.element(document.getElementsByClassName("create-ua-button")[0])[0].style.display="block",angular.element(document.getElementsByClassName("side-sidebar")[0])[0].style.display="none"}}]),angular.module("appApp").controller("MineCtrl",["$scope","ngDialog","myVilleAPI",function(a,b,c){a.$emit("filterForce",2),a.centerOnMap=function(b){a.$emit("centerOnMap",b)},a.editUA=function(a){b.open({data:a,template:"views/edit_ua.html",appendClassName:"modal-edit-ua",controller:"EdituaCtrl"})},a.deleteUA=function(b){c.UAS["delete"](b._id).then(function(){a.$emit("leafletDirectiveMap.map.dragend")})}}]),angular.module("appApp").controller("EdituaCtrl",["$scope","myVilleAPI",function(a,b){a.tinymceOptions={onChange:function(a){},inline:!1,plugins:"advlist autolink link image lists charmap preview",skin:"lightgray",theme:"modern"},a.editUa=function(){b.UAS.update(a.ngDialogData._id,{title:a.ngDialogData.title,description:a.ngDialogData.description,publish:a.ngDialogData["private"].toString()}).then(function(b){a.closeThisDialog()})}}]),angular.module("appApp").controller("VoteCtrl",["$rootScope","$scope","myVilleAPI","AuthentificationService",function(a,b,c,d){twemoji.size=72,b.twemoji=twemoji,b.vote=[{smiley:"😍",isVote:!1,text:"J'aime"},{smiley:"😃",isVote:!1,text:"Wouah"},{smiley:"🤔",isVote:!1,text:"Bien pensé"},{smiley:"😴",isVote:!1,text:"Sans intérêt"},{smiley:"😣",isVote:!1,text:"J'aime pas"}],d.routeGuardian()&&c.Vote.getVote(b.ngDialogData._id).then(function(a){a&&(b.vote[a.data.vote[0]].isVote=!0)}),b.voteCount=b.ngDialogData.vote.length,b.doVote=function(a){b.vote[a].isVote?c.UAS.deleteVote(b.ngDialogData._id).then(function(){for(var a=0;a<b.vote.length;a++)b.vote[a].isVote&&(b.vote[a].isVote=!1,b.voteCount--)}):c.UAS.vote(b.ngDialogData._id,{vote:a}).then(function(){for(var c=!1,d=0;d<b.vote.length;d++)b.vote[d].isVote&&(c=!0),d==a?b.vote[d].isVote=!0:b.vote[d].isVote=!1;c||b.voteCount++})}}]),angular.module("appApp").run(["$templateCache",function(a){a.put("views/edit_ua.html",'<div id="singleUA"> <div class="ua-title"> Edition de {{ngDialogData.title}} </div> <div class="form-label"> <h1>Titre de l\'aménagement :</h1> <input type="text" ng-required ng-model="ngDialogData.title" placeholder="Nom de votre aménagement"> </div> <div class="form-label"> <h1>Description du projet :</h1> <textarea ng-required ui-tinymce="tinymceOptions" ng-model="ngDialogData.description"></textarea> </div> <div class="form-label"> <h1>Visibilité :</h1> <ul style="list-style: none"> <li> <input ng-model="ngDialogData.private" type="checkbox"> Privé </li> </ul> </div> <button class="btn-blue" ng-click="editUa()">Editer</button> </div>'),a.put("views/favorite.html",'<collapse-sidebar id="favoriteUA" heading-title="Favoris"> <div class="list-ua"> <div class="ua-row" ng-if="tabFavorite.length < 1"> <div> Il n\'y a rien pour l\'instant 😞 </div> </div> <div class="ua-row" ng-repeat="favorite in tabFavorite"> <div class="row-title"> <a ng-click="centerOnMap(favorite.ua.data.location.geometries)">{{favorite.ua.data.title}}</a> </div> <div class="row-owner"> {{favorite.owner}} </div> </div> </div> </collapse-sidebar>'),a.put("views/login.html",'<div class="login-side" ng-if="log == 1"> <div ng-if="message"> {{message}} </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-user"></i></div> <input type="text" ng-keyup="$event.keyCode == 13 && loginClick()" ng-model="user.email" placeholder="Email"> </div> </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-lock"></i></div> <input type="password" ng-keyup="$event.keyCode == 13 && loginClick()" ng-model="user.password" placeholder="Password"> <div class="top-right"><a ng-click="switchMode(\'forgot\')">Mot de passe oublié ?</a></div> </div> </div> <button class="btn-blue" ng-click="loginClick()">Login</button> <div class="action-group"> <div class="remember-action"> <input type="checkbox" checked class="checkbox-input"> Se souvenir de moi </div> <div class="create-account"> Vous n\'avez pas de compte ? <a ng-click="switchMode(\'signup\')">S\'inscrire</a> </div> </div> <div class="social-group"> <div class="social-txt"> Ou connectez vous avec </div> <div class="social-list"> <div ng-click="loginFB()" class="social-circle"> <i class="fa fa-facebook"></i> </div> <div ng-click="loginGoogle()" class="social-circle"> <i class="fa fa-google"></i> </div> </div> </div> </div> <div class="login-side" ng-if="log == 2"> <div class="top-left-dialog"><a ng-click="switchMode(\'login\')">&lsaquo;</a></div> <h1>Inscription</h1> <div ng-if="message"> {{message}} </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-user"></i></div> <input type="text" ng-model="signupUser.nickname" placeholder="Pseudonyme"> </div> </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-lock"></i></div> <input type="password" ng-model="signupUser.password" placeholder="Mot de passe"> </div> </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-user"></i></div> <input type="email" ng-model="signupUser.email" placeholder="Email"> </div> </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-user"></i></div> <input type="phonenumber" ng-model="signupUser.phonenumber" placeholder="Numéro de téléphone"> </div> </div> <button class="btn-blue" ng-click="createClick()">Créer compte</button> </div> <div class="login-side" ng-if="log == 3"> <div class="top-left-dialog"><a ng-click="switchMode(\'login\')">&lsaquo;</a></div> <h1>Mot de passe oublié</h1> <div ng-if="message"> {{message}} </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-mail"></i></div> <input type="text" ng-model="forgotPwd.email" placeholder="Email"> </div> </div> <button class="btn-blue" ng-click="forgotClick()">GO !</button> </div>'),a.put("views/mine.html",'<collapse-sidebar id="myUA" heading-title="{{\'Mes propositions\'}}"> <div class="list-ua"> <div class="ua-row" ng-if="cachedMarkers.features.length < 1"> <div> Il n\'y a rien pour l\'instant 😞 </div> </div> <div class="ua-row" ng-if="cachedMarkers && feature.properties._doc.owner.username == user.username" ng-repeat="feature in cachedMarkers.features"> <div class="row-title"> <a ng-click="centerOnMap(feature.geometry.geometries)">{{feature.properties._doc.title}}</a> </div> <div class="row-date"> {{feature.properties._doc.createdAt | formatDate}} </div> <div class="row-edit" ng-click="editUA(feature.properties._doc)"> <i title="Editer" class="fa fa-edit"></i> </div> <div class="row-edit" ng-click="deleteUA(feature.properties._doc)"> <i title="Supprimer" class="fa fa-close"></i> </div> </div> </div> </collapse-sidebar>'),a.put("views/modalUaCreated.html",'<div class="modalConfirm"> <h4>L\'aménagement a été crée avec succès !</h4> <button class="btn-blue" ng-click="okClick()">OK</button> </div>'),a.put("views/profile.html",'<collapse-sidebar id="profile" heading-title="{{userWanted.username}}"> <div class="profile-picture"> <div class="profile-avatar"> <img ng-src="{{userWanted.avatar ? \'http://localhost:3000/static/\' + userWanted.avatar : (userWanted.facebook_id) ? \'http://graph.facebook.com/\'+ userWanted.facebook_id +\'/picture\' : \'images/profile-default.9cda96ac.png\'}}"> </div> <div class="profile-nickname">{{userWanted.username}}</div> </div> </collapse-sidebar>'),a.put("views/profile_update.html",'<collapse-sidebar id="profile" heading-title="Mon profil"> <div class="profile-picture"> <div class="profile-avatar"> <img ng-src="{{user.avatar ? \'http://localhost:3000/static/\' + user.avatar : (user.facebook_id) ? \'http://graph.facebook.com/\'+ user.facebook_id +\'/picture\' : \'images/profile-default.9cda96ac.png\'}}"> <input type="file" id="new_avatar_file" onchange="angular.element(this).scope().editAvatarClick(this)" name="avatar"> </div> <div class="profile-nickname">{{user.username}}</div> <div ng-if="!editMode" class="profile-description" ng-if="user.description">{{user.description}}</div> <div ng-if="editMode && user.description" class="profile-description"><textarea>{{user.description}}</textarea></div> <div class="profile-detailled"> <div ng-if="message">{{message}}</div> <div class="edit-icon" ng-click="editBox()"><i ng-class="editMode ? \'fa fa-user\' : \'fa fa-pencil\'"></i></div> <h1>Pseudonyme</h1> <span ng-if="!editMode" class="edit-field">{{user.username}}</span> <span ng-if="editMode" class="edit-field"><input type="text" ng-model="editUser.username"></span> <h1>Email</h1> <span class="edit-field">{{user.email}}</span> <h1 ng-if="user.phonenumber">Numéro</h1> <span ng-if="user.phonenumber" class="edit-field">{{user.phonenumber}}</span> <h1 ng-if="editMode">Ancien mot de passe</h1> <span ng-if="editMode" class="edit-field"><input type="password" ng-model="editUser.Opassword"></span> <h1 ng-if="editMode">Nouveau mot de passe</h1> <span ng-if="editMode" class="edit-field"><input type="password" ng-model="editUser.Npassword"></span> <button ng-if="editMode" class="btn-blue" ng-click="editClick()">Editer</button> </div> </div> </collapse-sidebar>'),a.put("views/reset_password.html",'<div class="login-side"> <h1>Réinitialisation de mot de passe</h1> <div ng-if="message"> {{message}} </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-lock"></i></div> <input type="password" ng-model="resetPwd.pwd1" placeholder="Nouveau mot de passe"> </div> </div> <div class="form-group"> <div class="input-group"> <div class="input-group-addon"><i class="fa fa-lock"></i></div> <input type="password" ng-model="resetPwd.pwd2" placeholder="Retaper votre nouveau mot de passe"> </div> </div> <button class="btn-blue" ng-click="forgotClick()">Réinitialiser</button> </div>'),a.put("views/single_ua.html",'<div id="singleUA"> <div class="socialUA"> <iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&width=94&layout=button_count&action=like&size=small&show_faces=true&share=false&height=30&appId=1731346920416495" width="100" height="30" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowtransparency="true"></iframe> <iframe src="https://platform.twitter.com/widgets/tweet_button.html?size=l&url=https%3A%2F%2Fdev.twitter.com%2Fweb%2Ftweet-button&via=twitterdev&related=twitterapi%2Ctwitter&text=custom%20share%20text&hashtags=example%2Cdemo" width="140" height="30" scrolling="no" frameborder="0" title="Twitter Tweet Button" style="border: 0; overflow: hidden"> </iframe> <div class="vote-counter display-desktop" ng-if="token"> {{voteCount}} {{voteCount > 1 ? \'réactions\' : \'réaction\'}}, et vous ? </div> <div ng-if="token" class="voteList display-desktop"> <div class="vote-column" ng-repeat="x in vote"> <div class="vote-column-heading" ng-class="x.isVote ? \'voted\' : \'no-voted\'" ng-click="doVote($index)" ng-bind-html="twemoji.parse(x.smiley)"> </div> <div class="vote-column-overlay"> {{x.text}} </div> </div> </div> </div> <div class="vote-counter display-tablet" ng-if="token"> {{voteCount}} {{voteCount > 1 ? \'réactions\' : \'réaction\'}}, et vous ? </div> <div ng-if="token" class="voteList display-tablet"> <div class="vote-column" ng-repeat="x in vote"> <div class="vote-column-heading" ng-class="x.isVote ? \'voted\' : \'no-voted\'" ng-click="doVote($index)" ng-bind-html="twemoji.parse(x.smiley)"> </div> <div class="vote-column-overlay"> {{x.text}} </div> </div> </div> <div class="ua-title"> {{ngDialogData.title}} </div> <div ng-bind-html="ngDialogData.description" class="ua-description"> </div> </div>'),a.put("views/ua.html",'<collapse-sidebar id="createUA" heading-title="Créer un aménagement"> <div class="form-dable"> <div ng-if="message"> {{message}} </div> <div class="form-label"> <h1>Titre</h1> <span class="edit-field"><input type="text" ng-model="ua.title"></span> </div> <div class="form-label"> <h1>Description</h1> <textarea ui-tinymce="tinymceOptions" ng-model="ua.desc" placeholder="Entrez votre texte ici">\n		</div>\n		<button class="btn-blue create-btn" ng-click="showEditMap()">Choisir l\'emplacement de l\'aménagement</button>\n	</div>\n</collapse-sidebar>')}]);